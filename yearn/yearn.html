<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Yearning Simulator 1.0 — Michael Edition</title>
<style>
  :root {
    --bg: #1a1a1a;
    --fg: #e7e7e7;
    --accent: #77ff77;
    --danger: #ff6b6b;
    --warn: #ffd166;
    --good: #5ad1a6;
    --panel: #2a2a2a;
    --border: #000;
  }
  html, body { height: 100%; }
  body {
    margin: 0; background: var(--bg); color: var(--fg);
    font: 14px/1.4 monospace; image-rendering: pixelated;
  }
  .wrap {
    max-width: 900px; margin: 0 auto; padding: 16px;
    display: grid; gap: 12px;
    grid-template-columns: 280px 1fr;
  }
  h1 { margin: 0 0 6px; font-size: 16px; }
  .frame {
    background: var(--panel);
    border: 4px solid var(--border);
    box-shadow: 0 0 0 4px #444, 0 0 0 8px var(--border);
    padding: 8px;
  }
  #michael {
    width: 256px; height: 256px; display: block; margin: 0 auto 8px;
    background: #222; border: 4px solid #000;
  }
  .stat { margin: 8px 0; }
  .stat label { display: block; margin-bottom: 4px; }
  .bar {
    height: 18px; background: #111; border: 3px solid #000; position: relative;
  }
  .bar > i {
    display: block; height: 100%; background: var(--accent); width: 50%;
  }
  .row { display: flex; gap: 8px; flex-wrap: wrap; }
  button {
    background: #333; color: var(--fg);
    border: 4px solid #000; padding: 8px 10px; cursor: pointer;
    box-shadow: 0 0 0 4px #555, 0 0 0 8px #000;
    text-transform: uppercase; letter-spacing: .5px;
  }
  button:disabled { opacity: .5; cursor: not-allowed; }
  .log { max-height: 260px; overflow: auto; background:#111; padding:8px; }
  .log p { margin: 0 0 6px; }
  .tiny { opacity:.8; font-size:12px; }
  .bad { color: var(--danger); }
  .meh { color: var(--warn); }
  .good { color: var(--good); }
  .footer { grid-column: 1 / -1; text-align:center; opacity:.6; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="frame">
      <h1>MICHAEL: YEARNING SIMULATOR</h1>
      <canvas id="michael" width="128" height="128"></canvas>

      <div class="stat">
        <label>Yearning</label>
        <div class="bar"><i id="yearningBar"></i></div>
      </div>
      <div class="stat">
        <label>Confidence</label>
        <div class="bar"><i id="confidenceBar"></i></div>
      </div>
      <div class="stat">
        <label>Sanity</label>
        <div class="bar"><i id="sanityBar"></i></div>
      </div>
    </div>

    <div class="frame">
      <div class="row" id="actions">
        <button data-act="textHer">Text Her “hey”</button>
        <button data-act="stalk">Stalk IG</button>
        <button data-act="run">Go for a run</button>
        <button data-act="grass">Touch grass</button>
        <button data-act="journal">Journal 3 lines</button>
        <button data-act="sadSong">Listen to sad song</button>
        <button data-act="water">Drink water</button>
        <button data-act="buffDome">Buff the dome</button>
        <button data-act="mongolia">Book flight to Mongolia</button>
        <button data-act="commit">Commit to plans</button>
        <button data-act="reset" title="Start over">Reset</button>
      </div>

      <div class="log" id="log"></div>
      <p class="tiny">Goal: keep Yearning &lt; 35 for a full minute to achieve <b>Temporary Peace</b>. Beware random events and Michael’s tragic thumbs.</p>
    </div>

    <div class="footer tiny">Made with love and questionable judgment. © You, probably.</div>
  </div>

<script>
(() => {
  const state = {
    name: "Michael",
    yearning: 22,
    confidence: 58,
    sanity: 62,
    chillStreak: 0,           // seconds under threshold
    alive: true,
    tick: 0
  };

  const els = {
    cv: document.getElementById('michael'),
    yearn: document.getElementById('yearningBar'),
    conf: document.getElementById('confidenceBar'),
    san: document.getElementById('sanityBar'),
    log: document.getElementById('log'),
    actions: document.getElementById('actions')
  };
  const ctx = els.cv.getContext('2d');

  // Utility
  const clamp = (v,min=0,max=100)=>Math.max(min,Math.min(max,v));
  const pct = v => `${clamp(v)}%`;
  const log = (html) => {
    const p = document.createElement('p');
    p.innerHTML = html;
    els.log.prepend(p);
  };
  const rnd = (a,b)=>Math.floor(Math.random()*(b-a+1))+a;

  function updateBars() {
    els.yearn.style.width = pct(state.yearning);
    els.conf.style.width = pct(state.confidence);
    els.san.style.width = pct(state.sanity);

    // color shifts for yearning
    els.yearn.style.background = state.yearning >= 70 ? "#ff6b6b" :
                                 state.yearning >= 40 ? "#ffd166" : "#77ff77";
  }

  // Pixel Michael (128x128 canvas, scaled via CSS with image-rendering: pixelated)
  function drawMichael() {
    const p = 8; // pixel size for drawing grid-aligned squares
    ctx.imageSmoothingEnabled = false;

    // bg checker
    for (let y=0; y<128; y+=p){
      for (let x=0; x<128; x+=p){
        const dark = ((x+y)/p)%2===0;
        ctx.fillStyle = dark ? "#202020" : "#181818";
        ctx.fillRect(x,y,p,p);
      }
    }

    // Head
    // Bald king: a chunky oval-ish head
    const skin = "#f1c27d";
    for (let y=32; y<=96; y+=p){
      for (let x=32; x<=96; x+=p){
        const dx = (x-64)/32, dy = (y-64)/40;
        if (dx*dx + dy*dy <= 1) {
          ctx.fillStyle = skin;
          ctx.fillRect(x,y,p,p);
        }
      }
    }

    // Shiny bald highlight
    ctx.fillStyle = "rgba(255,255,255,0.15)";
    ctx.fillRect(56,36,p*3,p*2);

    // Eyes
    const eyeY = 64;
    const eyeMood = state.yearning>80 ? 2 : 0; // droop when yearning hard
    ctx.fillStyle = "#000";
    ctx.fillRect(48, eyeY+eyeMood, p, p);
    ctx.fillRect(80, eyeY+eyeMood, p, p);

    // Mouth
    const mouthY = 88;
    ctx.fillStyle = "#000";
    if (state.yearning < 35 && state.sanity > 55) {
      // tiny smile
      ctx.fillRect(64-p, mouthY, p*3, p);
      ctx.fillRect(64-p, mouthY- p, p, p);
      ctx.fillRect(64+p, mouthY- p, p, p);
    } else if (state.yearning > 75) {
      // :(
      ctx.fillRect(56, mouthY, p*6, p);
      ctx.clearRect(64-p, mouthY, p*2, p); // make a dip
      ctx.fillRect(64-p, mouthY+p, p*2, p);
    } else {
      // flat
      ctx.fillRect(56, mouthY, p*6, p);
    }

    // Tear when yearning high
    if (state.yearning > 80) {
      ctx.fillStyle = "#6ecbff";
      ctx.fillRect(48, eyeY + p, p, p);
      if (state.tick % 2 === 0) ctx.fillRect(48, eyeY + p*2, p, p);
    }

    // Tiny broken heart floats when yearning spikes
    if (state.tickFlash && state.tick % 2 === 0) {
      const hx = 20, hy = 18;
      ctx.fillStyle = "#ff5a7a";
      // crude pixel heart split
      const blocks = [
        [0,1],[1,0],[2,0],[3,1],[2,2],[1,2],[0,3],
        [5,1],[6,0],[7,0],[8,1],[7,2],[6,2],[5,3]
      ];
      blocks.forEach(([dx,dy])=>ctx.fillRect(hx+dx*p, hy+dy*p, p, p));
      // crack
      ctx.fillStyle = "#000";
      ctx.fillRect(hx+3*p, hy+2*p, p, p);
      ctx.fillRect(hx+4*p, hy+3*p, p, p);
    }
  }

  function pushOutcome(text, cls="meh") {
    log(`<span class="${cls}">${text}</span>`);
  }

  function actionCooldown(btn) {
    btn.disabled = true;
    setTimeout(()=>btn.disabled=false, 700);
  }

  const actions = {
    reset() {
      state.yearning = 22; state.confidence = 58; state.sanity = 62;
      state.chillStreak = 0; state.alive = true; state.tick = 0;
      log(`<b>He is reborn.</b> Michael vows to be normal this time.`);
    },
    textHer() {
      const btn = this;
      actionCooldown(btn);
      if (!state.alive) return;
      const outcomes = [
        {t:"She leaves him on read. Yearning surges.", y:+18, c:-10, s:-6},
        {t:"She replies 'hey :)' 47 minutes later. Confusing. Yearning spikes anyway.", y:+14, c:-4, s:-4},
        {t:"Auto-correct turns 'hey' into 'heyyy'. Catastrophic.", y:+22, c:-14, s:-8},
        {t:"Message unsent. Immediate shame spiral.", y:+16, c:-12, s:-10}
      ];
      const o = outcomes[rnd(0,outcomes.length-1)];
      state.yearning = clamp(state.yearning + o.y);
      state.confidence = clamp(state.confidence + o.c);
      state.sanity = clamp(state.sanity + o.s);
      state.tickFlash = true;
      pushOutcome(o.t, "bad");
    },
    stalk() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      const bits = [
        "She posted a story of someone's elbow. Is that… a man’s elbow?",
        "New photo dump. Slide 7 is a sunset. Slide 8 is a suspicious silhouette.",
        "You scroll 3 years back. Accidental like narrowly avoided.",
        "Close friends story. You are not on it. Ouch."
      ];
      state.yearning = clamp(state.yearning + rnd(8,12));
      state.sanity = clamp(state.sanity - rnd(4,7));
      pushOutcome(bits[rnd(0,bits.length-1)], "bad");
      state.tickFlash = true;
    },
    mongolia() {
    const btn = this; actionCooldown(btn);
    if (!state.alive) return;
    state.yearning   = clamp(state.yearning - rnd(14,22)); // escape the loop
    state.confidence = clamp(state.confidence + rnd(5,8)); // decisive king
    state.sanity     = clamp(state.sanity + rnd(1,3));     // fresh air on the steppe
    pushOutcome("Books a one-way to Ulaanbaatar. The vast steppe calls; yearning retreats.", "good");
    state.tickFlash = true;
    },

    commit() { // per your spec: decreases sanity
    const btn = this; actionCooldown(btn);
    if (!state.alive) return;
    state.sanity = clamp(state.sanity - rnd(6,10));
    pushOutcome("Adds plans to calendar. Immediate calendar dread. Why did he do that.", "bad");
    },
    
    run() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.yearning = clamp(state.yearning - rnd(6,10));
      state.sanity = clamp(state.sanity + rnd(4,7));
      state.confidence = clamp(state.confidence + rnd(2,4));
      pushOutcome("Endorphins acquired. Michael remembers he has legs.", "good");
    },
    grass() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.yearning = clamp(state.yearning - rnd(5,8));
      state.sanity = clamp(state.sanity + rnd(6,9));
      pushOutcome("He touches grass. The grass touches back (emotionally).", "good");
    },
    journal() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.yearning = clamp(state.yearning - rnd(3,6));
      state.sanity = clamp(state.sanity + rnd(5,8));
      pushOutcome("Writes: 'I will be so normal.' Spells 'normal' wrong.", "meh");
    },
    sadSong() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.yearning = clamp(state.yearning + rnd(5,8));
      state.sanity = clamp(state.sanity - rnd(1,3));
      pushOutcome("Listens to The Cure. Vibes immaculate, stability questionable.", "meh");
      state.tickFlash = true;
    },
    water() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.yearning = clamp(state.yearning - 2);
      state.sanity = clamp(state.sanity + 2);
      pushOutcome("Hydration achieves almost nothing, but we try.", "meh");
    },
    buffDome() {
      const btn = this; actionCooldown(btn);
      if (!state.alive) return;
      state.confidence = clamp(state.confidence + rnd(4,6));
      pushOutcome("Bald polish applied. Cranial reflectivity +15 charisma.", "good");
    }
  };

  // Hook up buttons
  els.actions.addEventListener('click', (e) => {
    const b = e.target.closest('button');
    if (!b) return;
    const fn = b.dataset.act;
    if (!fn) return;
    if (fn === 'reset') { actions.reset(); updateBars(); drawMichael(); return; }
    if (typeof actions[fn] === 'function') actions[fn].call(b);
  });

  // Random events every ~10s
  function randomEvent() {
    if (!state.alive) return;
    const roll = rnd(1,100);
    if (roll < 22) {
      state.yearning = clamp(state.yearning + rnd(7,12));
      state.confidence = clamp(state.confidence - rnd(2,4));
      pushOutcome("She liked your story from 6 days ago. Algorithmic necromancy.", "meh");
      state.tickFlash = true;
    } else if (roll > 92) {
      state.yearning = clamp(state.yearning - rnd(5,9));
      state.sanity = clamp(state.sanity + rnd(4,6));
      pushOutcome("Group chat sends memes. Brain chemistry briefly repaired.", "good");
    }
  }

  // Win/Lose checks
  function checkEndStates() {
    if (state.yearning >= 100) {
      state.alive = false;
      pushOutcome("<b>Overload.</b> Michael texts his ex and buys concert tickets he can’t afford. GAME OVER.", "bad");
    } else if (state.sanity <= 0 || state.confidence <= 0) {
      state.alive = false;
      pushOutcome("<b>Spiral achieved.</b> Michael contemplates bangs despite being bald. GAME OVER.", "bad");
    } else {
      const under = state.yearning < 35;
      state.chillStreak = under ? state.chillStreak + 1 : 0;
      if (state.chillStreak >= 60) {
        state.alive = false;
        pushOutcome("<b>Temporary Peace.</b> He forgets her for a whole minute. You win (for now).", "good");
      }
    }
  }

  // Passive drift per tick
  function passiveDrift() {
    // yearning creeps up, sanity drips down if yearning high
    state.yearning = clamp(state.yearning + (Math.random() < 0.6 ? 1 : 0));
    if (state.yearning > 60 && Math.random() < 0.5) state.sanity = clamp(state.sanity - 1);
    if (state.confidence > 20 && Math.random() < 0.15) state.confidence = clamp(state.confidence - 1);
  }

  // Main loop
  actions.reset();
  updateBars();
  drawMichael();

  setInterval(() => {
    if (!state.alive) return;
    state.tick++;
    state.tickFlash = false;
    passiveDrift();
    if (state.tick % 10 === 0) randomEvent();
    checkEndStates();
    updateBars();
    drawMichael();
  }, 1000);
})();
</script>
</body>
</html>
